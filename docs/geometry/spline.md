# spline

Generate smooth Catmull-Rom spline paths through control points.

## Description

`spline` creates smooth curves that pass through a series of control points using Catmull-Rom interpolation. It returns an SVG path string that can be used directly with SVG.JS path elements. The function supports open and closed paths, adjustable tension for curve tightness, and an optional callback for accessing individual path segments.

## Syntax

```javascript
spline(points, tension, close, callback)
```

## Parameters

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| `points` | `Array<{x, y}>` | `[]` | Array of control points with x and y properties |
| `tension` | `number` | `0.5` | Controls curve tightness (0 = loose, 1 = tight) |
| `close` | `boolean` | `false` | If `true`, connects the last point back to the first |
| `callback` | `function` | `undefined` | Optional callback receiving `(type, [x, y])` for each segment |

## Return Value

| Type | Description |
|------|-------------|
| `string` | SVG path string (e.g., `"M0,0L1.5,2.3L3,4.1..."`) |

## Examples

### Basic Curved Line

```javascript
import { SVG } from '@svgdotjs/svg.js'
import { seedPRNG, random, spline } from '@georgedoescode/generative-utils'

const svg = SVG().addTo('#container').viewbox(0, 0, 400, 400)
seedPRNG('basic-spline')

// Generate random control points
const points = []
for (let i = 0; i < 6; i++) {
  points.push({
    x: 50 + i * 60,
    y: random(100, 300)
  })
}

// Create smooth curve through points
const pathData = spline(points)

svg.path(pathData)
  .fill('none')
  .stroke({ color: '#264653', width: 3 })
```

### Closed Shape

```javascript
import { SVG } from '@svgdotjs/svg.js'
import { seedPRNG, random, spline } from '@georgedoescode/generative-utils'

const svg = SVG().addTo('#container').viewbox(0, 0, 400, 400)
seedPRNG('blob-shape')

const centerX = 200
const centerY = 200
const numPoints = 8
const radius = 100

// Generate points in a circle with random variation
const points = []
for (let i = 0; i < numPoints; i++) {
  const angle = (i / numPoints) * Math.PI * 2
  const r = radius + random(-30, 30)
  points.push({
    x: centerX + Math.cos(angle) * r,
    y: centerY + Math.sin(angle) * r
  })
}

// Create closed blob shape
const pathData = spline(points, 0.5, true)

svg.path(pathData)
  .fill('#2a9d8f')
  .stroke({ color: '#264653', width: 2 })
```

### Tension Comparison

```javascript
import { SVG } from '@svgdotjs/svg.js'
import { spline } from '@georgedoescode/generative-utils'

const svg = SVG().addTo('#container').viewbox(0, 0, 400, 300)

const points = [
  { x: 50, y: 150 },
  { x: 150, y: 50 },
  { x: 250, y: 250 },
  { x: 350, y: 150 }
]

const tensions = [0.2, 0.5, 0.8]
const colors = ['#e63946', '#457b9d', '#2a9d8f']

tensions.forEach((tension, i) => {
  const pathData = spline(points, tension)

  svg.path(pathData)
    .fill('none')
    .stroke({ color: colors[i], width: 2 })

  svg.text(`tension: ${tension}`)
    .move(10, 20 + i * 20)
    .font({ size: 12, family: 'monospace' })
    .fill(colors[i])
})

// Show control points
points.forEach(p => {
  svg.circle(6).center(p.x, p.y).fill('#333')
})
```

### Using the Callback

```javascript
import { SVG } from '@svgdotjs/svg.js'
import { seedPRNG, random, spline } from '@georgedoescode/generative-utils'

const svg = SVG().addTo('#container').viewbox(0, 0, 400, 400)
seedPRNG('callback-example')

const points = []
for (let i = 0; i < 5; i++) {
  points.push({
    x: 50 + i * 80,
    y: random(100, 300)
  })
}

// Collect all points generated by the spline
const allPoints = []

const pathData = spline(points, 0.5, false, (type, coords) => {
  allPoints.push({ x: coords[0], y: coords[1] })
})

// Draw the path
svg.path(pathData)
  .fill('none')
  .stroke({ color: '#264653', width: 2 })

// Draw circles at each interpolated point
allPoints.forEach((p, i) => {
  if (i % 5 === 0) {  // Every 5th point
    svg.circle(4).center(p.x, p.y).fill('#e63946')
  }
})
```

### Animated Flowing Lines

```javascript
import { SVG } from '@svgdotjs/svg.js'
import { seedPRNG, random, spline } from '@georgedoescode/generative-utils'

const svg = SVG().addTo('#container').viewbox(0, 0, 400, 400)
seedPRNG('flowing-lines')

// Create multiple flowing lines
for (let line = 0; line < 5; line++) {
  const points = []
  const yOffset = 80 + line * 60

  for (let i = 0; i < 8; i++) {
    points.push({
      x: i * 60,
      y: yOffset + random(-30, 30)
    })
  }

  const pathData = spline(points, 0.4)

  svg.path(pathData)
    .fill('none')
    .stroke({
      color: '#457b9d',
      width: random(1, 4),
      opacity: random(0.4, 1)
    })
}
```

## Notes

- Returns an empty string if fewer than 2 points are provided
- The tension value is halved internally (0.5 becomes 0.25 for the algorithm)
- Each segment between control points is divided into 20 interpolated points for smoothness
- The callback receives `'MOVE'` for the first point and `'LINE'` for all subsequent points
- Path strings use SVG path commands: `M` (move), `L` (line), `Z` (close)

## See Also

- [pointsInPath](points-in-path.md) - Extract points from an existing path
- [createVoronoiDiagram](create-voronoi-diagram.md) - Generate complex cell shapes
